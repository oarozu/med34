{% extends '::base.html.twig' %}

{% block body -%}
    <h1>Plan de Gesti贸n de {{ entity.id.user.nombres}} {{ entity.id.user.apellidos}} : {{ entity.id.user.id}} </h1>

     <table class="table table-bordered table-striped hidden-mobile" style="width: 95%">
        <tbody>
            <tr>
                <td>Fecha creaci贸n: {{ entity.fechacreacion? entity.fechacreacion|date('Y-m-d H:i:s') :'' }}</td>
                <td>Fecha cierre: {{ entity.fechacierre? entity.fechacierre|date('Y-m-d H:i:s') : '' }}</td>
            </tr>
            <tr>
                <td>Fecha Autoevaluaci贸n: {{ entity.fechaautoevaluacion? entity.fechaautoevaluacion|date('Y-m-d H:i:s') : '' }}</td>
                <td>Autoevaluaci贸n: {{ entity.autoevaluacion }}</td>
            </tr>
            <tr>
                <td colspan="2">Observaciones: {{ entity.observaciones }}</td>
            </tr>
        </tbody>
    </table>  
    
  <table class="table table-bordered table-striped hidden-mobile" style="width: 95%">
        <thead>
            <tr>
                <th>Actividad</th>
                <th>Horas</th>
                <th>Auto</th>
            </tr>
        </thead>
        <tbody>
        {% set temp = 'temp' %} {% set num = 0 %} {% set totalhoras = 0 %}
        {% for actividad in entity.actividades %}
           <tr>
                    {%if temp != actividad.actividad.rol.nombre %} 
                <td>
                    <b>ROL:
                    {{actividad.actividad.rol.nombre}}
                    {% set temp = actividad.actividad.rol.nombre %}        
                    </b>
                    </td>
                    <td></td>
                    <td></td>
                    {%endif%}
               </tr>     
            <tr>
                {% set num = num+1 %}
                <td>{{num}}.     
                {{ actividad.actividad.descripcion }}
                {%if actividad.actividad.textoampliacion %}
                <font color="#F87217">{{actividad.descripcion}}</font>
                {%endif%}
                </td>
                <td>{{actividad.horas}} {% set totalhoras = totalhoras+actividad.horas %}</td>
                <td>
                  {%if actividad.autoevaluacion is null%}
                   <a data-toggle="modal" href="{{ path('actividadplang_edit', { 'id': actividad.id }) }}" data-target="#myModal" class="btn btn-primary btn-xs"><i class="fa fa-edit"></i></a>     
                {%else%}
                   {{actividad.autoevaluacion}}
                    {%endif%}   
                </td>
               </tr>
        {% endfor %}
               <tr>
                   <td align="right">Total Horas: </td>
                   <td>{{totalhoras}}</td>
               </tr>     
        </tbody>
    </table>
    <table class="table table-bordered table-striped hidden-mobile" style="width: 95%">
  <tr>
    <th>Avalador</th>
    <th>Perfil</th>
    <th>Fecha de Aval</th>
    <th>Estado</th>
  </tr>
  {% for aval in entity.avales %}
  <tr>
    <td>{{aval.user.nombres}} {{aval.user.apellidos}}</td>
    <td>{{aval.perfil}}</td>
    <td>{{aval.fechaAval? aval.fechaAval|date('Y-m-d H:i') : ''}}</td>
    <td>
{%if aval.avalado == 1%}
Aprobado
{%elseif aval.avalado == 2%}
<font color="#F87217">No aprobado</font>
{%else%}
Sin revisar
{%endif%}

    </td>
  </tr>
    <tr>
    <td  colspan="5"><b>Observaciones: </b>{{aval.observaciones}}</td>
  </tr>
  {% endfor %}  
</table>
    
<div class="modal fade" data-refresh="true" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog modal-lg">
<div class="modal-content">
</div></div></div>    
    
{% endblock %}
